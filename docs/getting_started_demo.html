<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Demo - Using the scaffolding-cli to build an application · Amido Stacks Webapp</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="[![npm](https://img.shields.io/npm/dt/@amidostacks/scaffolding-cli)](https://www.npmjs.com/package/@amidostacks/scaffolding-cli)"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Demo - Using the scaffolding-cli to build an application · Amido Stacks Webapp"/><meta property="og:type" content="website"/><meta property="og:url" content="https://amido.github.io/stacks-webapp-template/"/><meta property="og:description" content="[![npm](https://img.shields.io/npm/dt/@amidostacks/scaffolding-cli)](https://www.npmjs.com/package/@amidostacks/scaffolding-cli)"/><meta property="og:image" content="https://amido.github.io/stacks-webapp-template/img/logo.png"/><meta name="twitter:card" content="summary"/><meta name="robots" content="noindex"/><link rel="shortcut icon" href="/stacks-webapp-template/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script src="/stacks-webapp-template/js/scrollSpy.js"></script><link rel="stylesheet" href="/stacks-webapp-template/css/main.css"/><script src="/stacks-webapp-template/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/stacks-webapp-template/"><img class="logo" src="/stacks-webapp-template/img/thumbnail_stacks.png" alt="Amido Stacks Webapp"/><h2 class="headerTitleWithLogo">Amido Stacks Webapp</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/stacks-webapp-template/docs/" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/stacks-webapp-template/docs/monorepo" target="_self">About Stacks</a></li><li class=""><a href="https://github.com/amido/stacks" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Getting Started</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/">About Amido Stacks</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/stacks-webapp-template/docs/getting_started_demo">Demo - Using the scaffolding-cli to build an application</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/getting_started_dev">Dev - Using the repo to build an application</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/monorepo">Stacks Monorepo</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Guides<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/deployment">Deployment</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/publishing">Publishing Packages</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/publishing_nuget">Publishing NuGet Packages</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/pipeline_templates">Pipeline Templates</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/infrastructure">Infrastructure</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Testing<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/testing">Testing and Quality</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/testing_static">Static Code Analysis</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Packages<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/packages">Packages</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/cli_process">CLI</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Supporting Docs<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/browser_support">Browser Support</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/server_side_cache">Server Side Cache</a></li><li class="navListItem"><a class="navItem" href="/stacks-webapp-template/docs/faq">FAQ</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="/edit/master/docs/getting_started_demo.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Demo - Using the scaffolding-cli to build an application</h1></header><article><div><span><p><a href="https://www.npmjs.com/package/@amidostacks/scaffolding-cli"><img src="https://img.shields.io/npm/dt/@amidostacks/scaffolding-cli" alt="npm"></a></p>
<p>Please refer to the <a href="https://github.com/amido/stacks-webapp-template/tree/master/packages/scaffolding-cli">scaffolding-cli</a> package for more information.</p>
<h2><a class="anchor" aria-hidden="true" id="scaffolding-cli"></a><a href="#scaffolding-cli" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scaffolding-cli</h2>
<p>Builds a Node.js with React Server Side Rendered Webapp Template, with
accompanying infrastruce code. All from your CLI.</p>
<h2><a class="anchor" aria-hidden="true" id="getting-started"></a><a href="#getting-started" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Getting Started</h2>
<p>We are using npx to execute and create the
<a href="./packages/scaffolding-cli">template-cli</a>
<a href="https://www.npmjs.com/package/npx">npx</a>.</p>
<p>We are supporting and running <a href="https://nodejs.org/en/about/releases/">node@12</a>.
Please ensure that your local environment has the correct version
<a href="https://nodejs.org/en/download/">installed</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="create-a-ssr-webapp-from-template"></a><a href="#create-a-ssr-webapp-from-template" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a SSR webapp from template</h2>
<p>Creates an amidostacks template in your local directory much like
express-generate with an addition of <code>build/, deploy/, docs/, src/</code> folders as
per the Amido Stacks standards.</p>
<p>There is already a prebuilt version of this up on npm, if you don't wish to
build this locally you only need to execute steps 3, 4, 5 and 6</p>
<ol>
<li>Install dependencies required to generate the templated app:</li>
</ol>
<pre><code class="hljs css language-bash">$ <span class="hljs-built_in">cd</span> <span class="hljs-variable">${YOUR_GIT_STACKS_WEB_APP_PATH}</span>/stacks-webapp-template/packages/scaffolding-cli
$ npm install
$ npm run build
</code></pre>
<ol start="2">
<li>Watch your build</li>
</ol>
<pre><code class="hljs css language-bash">$ <span class="hljs-built_in">cd</span> <span class="hljs-variable">${YOUR_GIT_STACKS_WEB_APP_PATH}</span>/stacks-webapp-template/packages/scaffolding-cli
$ npm run build:watch
</code></pre>
<ol start="3">
<li>Change to a directory for testing - e.g. $HOME and run</li>
</ol>
<pre><code class="hljs css language-bash">$ <span class="hljs-built_in">cd</span> <span class="hljs-variable">${SELECTED_DIR}</span>
<span class="hljs-comment"># for a local deployment</span>
$ npx <span class="hljs-variable">${YOUR_GIT_STACKS_WEB_APP_PATH}</span>/stacks-webapp-template/packages/scaffolding-cli/dist/index.js run -i
<span class="hljs-comment"># for the npm repo</span>
npx @amidostacks/scaffolding-cli@latest run -i
</code></pre>
<ol start="4">
<li><p>Follow the CLI prompts to create a templated app with user defined
configuration: ssr this is why t - Project Name: <em>default</em>: current directory
(will create a directory with this name)</p>
<ul>
<li>Project Type: <em>default</em>: SSR (server side rendering)</li>
<li>Platform: <em>default</em>: AKS (Azure Kubernetes Service)</li>
<li>CI/CD Tooling: <em>default</em>: AzureDevOps</li>
</ul></li>
<li><p>Navigate to the created project directory to install template dependencies:
e.g. ${SELECTED_DIR}/$PROJECT_NAME</p></li>
</ol>
<pre><code class="hljs css language-bash">$ <span class="hljs-built_in">cd</span> <span class="hljs-variable">${SELECTED_DIR}</span>/<span class="hljs-variable">$PROJECT_NAME</span>/src/
$ npm install
</code></pre>
<ol start="6">
<li>Build and run the app:</li>
</ol>
<pre><code class="hljs css language-bash">$ npm run build
$ npm run start
</code></pre>
<p>Open Browser and hit <a href="http://localhost:3000">http://localhost:3000</a></p>
<ol start="7">
<li>To test the deploy folder has been correctly provisioned prior to checking
you need to at this point in time copy over a sample backend-config and
terraform vars. Currently vars.tf and provider configuration is not
automatically updated. Future iterations will include this.</li>
</ol>
<p>The safest way to run and maintain this going forward is to rely on environment
variables for credentials as that is the way the pipeline will trigger the
executions of terraform.</p>
<p>Sample export script with correct environment vars:</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment">#WINDOWS: comment out the lines below</span>
$ <span class="hljs-built_in">export</span> ARM_CLIENT_ID= \
ARM_CLIENT_SECRET= \
ARM_SUBSCRIPTION_ID= \
ARM_TENANT_ID=
<span class="hljs-comment">##########################################################</span>

<span class="hljs-comment">#WINDOWS: uncomment the following lines and fill in values</span>
<span class="hljs-comment"># Set-Variable -Name "ARM_CLIENT_ID" -Value ""</span>
<span class="hljs-comment"># Set-Variable -Name "ARM_CLIENT_SECRET" -Value ""</span>
<span class="hljs-comment"># Set-Variable -Name "ARM_SUBSCRIPTION_ID" -Value ""</span>
<span class="hljs-comment"># Set-Variable -Name "ARM_TENANT_ID" -Value ""</span>
<span class="hljs-comment">##########################################################</span>

$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"
vnet_id                 = \"amido-stacks-vnet-uks-dev\"
rg_name                 = \"amido-stacks-rg-uks-dev\"
resource_group_location = \"uksouth\"
name_company            = \"amido\"
name_project            = \"stacks\"
name_component          = \"spa\"
name_environment        = \"dev\"
"</span> &gt; <span class="hljs-variable">${YOUR_GIT_STACKS_WEB_APP_PATH}</span>/stacks-webapp-template/deploy/terraform/azure/backend.local.tfvars
</code></pre>
<pre><code class="hljs css language-bash">$ <span class="hljs-built_in">cd</span> <span class="hljs-variable">${YOUR_GIT_STACKS_WEB_APP_PATH}</span>/deploy/terraform/azure
$ terraform init -backend-config=./backend.local.tfvars
$ terraform plan
</code></pre>
<p>We are using <a href="https://jestjs.io/">Jest.js</a> for testing including code coverage.</p>
<h2><a class="anchor" aria-hidden="true" id="versioning-and-publishing"></a><a href="#versioning-and-publishing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Versioning and Publishing</h2>
<p>For information on how to version and publish changes to this package, please
see <a href="/stacks-webapp-template/docs/publishing">Publishing Packages</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/stacks-webapp-template/docs/index"><span class="arrow-prev">← </span><span>About Amido Stacks</span></a><a class="docs-next button" href="/stacks-webapp-template/docs/getting_started_dev"><span>Dev - Using the repo to build an application</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#scaffolding-cli">Scaffolding-cli</a></li><li><a href="#getting-started">Getting Started</a></li><li><a href="#create-a-ssr-webapp-from-template">Create a SSR webapp from template</a></li><li><a href="#versioning-and-publishing">Versioning and Publishing</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/stacks-webapp-template/" class="nav-home"><img src="/stacks-webapp-template/img/thumbnail_stacks.png" alt="Amido Stacks Webapp" width="66" height="58"/></a><div><h5>Docs</h5><a href="/stacks-webapp-template/docs/en/index">Getting Started</a></div><div><h5>Community</h5><a href="https://amido.com/">Amido</a></div><div><h5>More</h5><a href="https://github.com/">GitHub</a></div></section><a href="https://github.com/amido/stacks" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/stacks-webapp-template/img/logo.png" alt="stacks-webapp-template" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Amido Ltd</section></footer></div><script src="http://localhost:undefined/livereload.js"></script></body></html>